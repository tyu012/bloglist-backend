(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{105:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(23),s=n.n(a),i=n(2),u=n(6),o=n.n(u),l=n(10),d=n(9),j=n(111),b=n(107),f=n(1),O=function(e){var t=e.handleLogin,n=e.username,r=e.setUsername,c=e.password,a=e.setPassword;return Object(f.jsxs)(j.a,{onSubmit:t,children:[Object(f.jsxs)(j.a.Group,{children:[Object(f.jsxs)("div",{className:"loginField",children:[Object(f.jsx)(j.a.Label,{children:"username"}),Object(f.jsx)(j.a.Control,{id:"usernameInput",type:"text",value:n,name:"Username",onChange:function(e){var t=e.target;return r(t.value)}})]}),Object(f.jsxs)("div",{className:"loginField",children:[Object(f.jsx)(j.a.Label,{children:"password"}),Object(f.jsx)(j.a.Control,{id:"passwordInput",type:"text",value:c,name:"Password",onChange:function(e){var t=e.target;return a(t.value)}})]})]}),Object(f.jsx)(b.a,{variant:"primary",id:"loginButton",type:"submit",children:"login"})]})},h=n(108),p=n(26),x=function(e){var t=e.blogs;return Object(f.jsx)("div",{children:Object(f.jsx)(h.a,{striped:!0,children:Object(f.jsx)("tbody",{children:t.map((function(e){return Object(f.jsx)("tr",{children:Object(f.jsx)("td",{children:Object(f.jsx)(p.b,{to:"/blogs/".concat(e.id),children:e.title})})},e.id)}))})})})},v=c.a.forwardRef((function(e,t){var n=e.submitBlog,c=Object(r.useState)(""),a=Object(d.a)(c,2),s=a[0],i=a[1],u=Object(r.useState)(""),o=Object(d.a)(u,2),l=o[0],O=o[1],h=Object(r.useState)(""),p=Object(d.a)(h,2),x=p[0],v=p[1];return Object(r.useImperativeHandle)(t,(function(){return{title:s,setTitle:i,author:l,setAuthor:O,url:x,setUrl:v}})),Object(f.jsx)(j.a,{onSubmit:function(e){e.preventDefault(),n({title:s,author:l,url:x,likes:0})},children:Object(f.jsxs)(j.a.Group,{children:[Object(f.jsxs)("div",{children:[Object(f.jsx)(j.a.Label,{children:"title:"}),Object(f.jsx)(j.a.Control,{id:"blogFormTitle",type:"text",value:s,name:"title",onChange:function(e){var t=e.target;return i(t.value)}})]}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.a.Label,{children:"author:"}),Object(f.jsx)(j.a.Control,{id:"blogFormAuthor",type:"text",value:l,name:"author",onChange:function(e){var t=e.target;return O(t.value)}})]}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j.a.Label,{children:"url:"}),Object(f.jsx)(j.a.Control,{id:"blogFormUrl",type:"text",value:x,name:"url",onChange:function(e){var t=e.target;return v(t.value)}})]}),Object(f.jsx)(b.a,{variant:"primary",id:"blogFormSubmit",type:"submit",children:"create"})]})})}));v.displayName="NewBlogForm";var m=v,g=n(109),w=function(e){var t=e.contents,n=e.isShowing,r=t?t.text:null;return n?Object(f.jsx)(g.a,{children:r}):Object(f.jsx)("div",{})},y=c.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),c=Object(d.a)(n,2),a=c[0],s=c[1],i={display:a?"none":""},u={display:a?"":"none"},o=function(){s(!a)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:o}})),Object(f.jsxs)("div",{className:"togglable",children:[Object(f.jsx)("div",{style:i,children:Object(f.jsx)(b.a,{className:"togglableButton",onClick:o,children:e.buttonLabel})}),Object(f.jsxs)("div",{style:u,children:[e.children,Object(f.jsx)(b.a,{variant:"secondary",onClick:o,children:"cancel"})]})]})}));y.displayName="Togglable";var k=y,S=n(16),I=n(28),E=n.n(I),L={getUsers:function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},T=function(e){return function(t){t({type:"SET_USERS_LIST",data:e})}},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USERS_LIST":return t.data;default:return e}},C=function(e){var t=e.name,n=e.blogs,r=e.id;return Object(f.jsxs)("tr",{children:[Object(f.jsx)("td",{children:Object(f.jsx)(p.b,{to:"/users/".concat(r),children:t})}),Object(f.jsx)("td",{children:n.length})]})},_=function(){var e=Object(S.b)(),t=Object(S.c)((function(e){return e.users}));return Object(r.useEffect)((function(){e(function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.getUsers();case 2:n=e.sent,t(T(n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(f.jsx)("div",{children:Object(f.jsx)(h.a,{children:Object(f.jsxs)("tbody",{children:[Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{}),Object(f.jsx)("th",{children:"blogs created"})]}),t.map((function(e){return Object(f.jsx)(C,{name:e.name,blogs:e.blogs,id:e.id},e.id)}))]})})})},N=function(e){var t=e.user,n=Object(S.c)((function(e){return e.blogs}));return t?Object(f.jsxs)("div",{children:[Object(f.jsx)("h3",{children:t.name}),Object(f.jsx)("h4",{children:"added blogs"}),Object(f.jsx)("ul",{children:n.filter((function(e){return e.user.id===t.id})).map((function(e){return Object(f.jsx)("li",{children:e.title},e.id)}))})]}):Object(f.jsx)("p",{children:"User ID not found"})},U="/api/blogs",D=null,A={getAll:function(){return E.a.get(U).then((function(e){return e.data}))},setToken:function(e){return D="bearer ".concat(e)},submit:function(){var e=Object(l.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:D}},e.next=3,E.a.post(U,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),like:function(){var e=Object(l.a)(o.a.mark((function e(t){var n,r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:D}},r=Object(i.a)(Object(i.a)({},t),{},{likes:t.likes+1}),e.next=4,E.a.put("".concat(U,"/").concat(t.id),r,n);case 4:return c=e.sent,e.abrupt("return",c.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(l.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:D}},e.next=3,E.a.delete("".concat(U,"/").concat(t.id),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),addComment:function(){var e=Object(l.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post(U+"/".concat(n,"/comments"),{comment:t});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},G={contents:{text:"Welcome to Bloglist!",success:!0},isShowing:!1,timeoutId:null},R=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2500;return function(n){var r=setTimeout((function(){n(F())}),t);n({type:"SHOW_NOTIF",data:{contents:e,timeoutId:r}})}},F=function(){return{type:"HIDE_NOTIF"}},H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_NOTIF":return e.timeoutId&&clearTimeout(e.timeoutId),{contents:t.data.contents,isShowing:!0,timeoutId:t.data.timeoutId};case"HIDE_NOTIF":return{contents:void 0,isShowing:!1,timeoutId:null};default:return e}},M=function(e,t){return t.likes-e.likes},J=function(e){return function(t){t({type:"CREATE_BLOG",data:e})}},W=function(e,t){return function(){var n=Object(l.a)(o.a.mark((function n(r){var c;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,A.submit(e);case 3:c=n.sent,console.log("blog submitted",c),r(J(Object(i.a)(Object(i.a)({},c),{},{user:t}))),r(R(c?{success:!0,text:"".concat(c.title," added")}:{success:!1,text:"blog creation failed"})),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(0),console.log("blog submission failed"),r(R({success:!1,text:"blog creation failed"}));case 13:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e){return n.apply(this,arguments)}}()},z=function(e){return function(){var t=Object(l.a)(o.a.mark((function t(n){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A.like(e);case 2:r=t.sent,n(R(r?{success:!0,text:"".concat(e.title," liked")}:{success:!1,text:"".concat(e.title," does not exist")})),n({type:"LIKE_BLOG",data:e});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_BLOGS":return t.data;case"CREATE_BLOG":return e.concat(t.data);case"LIKE_BLOG":return e.map((function(e){return e.id===t.data.id?Object(i.a)(Object(i.a)({},e),{},{likes:e.likes+1}):e})).sort(M);case"DELETE_BLOG":return e.filter((function(e){return e.id!==t.data.id}));case"ADD_COMMENT":return e.map((function(e){return e.id===t.data.id?Object(i.a)(Object(i.a)({},e),{},{comments:e.comments.concat(t.data.comment)}):e}));default:return e}},K=n(11),V=function(e){var t=e.comments,n=e.blogId;return Object(f.jsxs)("div",{children:[Object(f.jsx)("h4",{children:"comments"}),Object(f.jsx)(q,{blogId:n}),Object(f.jsx)("ul",{children:t.map((function(e,t){return Object(f.jsx)("li",{children:e},t)}))})]})},q=function(e){var t=e.blogId,n=Object(S.b)(),c=Object(r.useState)(""),a=Object(d.a)(c,2),s=a[0],i=a[1];return Object(f.jsx)("div",{children:Object(f.jsx)(j.a,{onSubmit:function(e){e.preventDefault(),n(function(e,t){return function(){var n=Object(l.a)(o.a.mark((function n(r){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,A.addComment(e,t);case 2:r(R({success:!0,text:"comment ".concat(e," added")})),r({type:"ADD_COMMENT",data:{comment:e,id:t}});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(s,t)),i("")},children:Object(f.jsxs)(j.a.Group,{children:[Object(f.jsx)(j.a.Control,{type:"text",value:s,onChange:function(e){var t=e.target;return i(t.value)}}),Object(f.jsx)(b.a,{variant:"primary",type:"submit",children:"submit"})]})})})},Q=function(e){var t=e.blog,n=e.user;if(!t)return Object(f.jsx)("p",{children:"Blog ID not found"});var r=Object(S.b)(),c=Object(K.f)(),a=function(){var e=Object(l.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),r(z(t));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s={display:n.username===t.user.username?"":"none"};return Object(f.jsxs)("div",{className:"detailedBlogInfo",children:[Object(f.jsx)("h3",{children:t.title}),Object(f.jsx)(h.a,{hover:!0,children:Object(f.jsxs)("tbody",{children:[Object(f.jsx)("tr",{children:Object(f.jsx)("td",{colSpan:2,children:Object(f.jsx)("a",{href:"https://"+t.url,children:t.url})})}),Object(f.jsxs)("tr",{className:"blogLikes",children:[Object(f.jsxs)("td",{children:[t.likes," likes"]}),Object(f.jsx)("td",{children:Object(f.jsx)(b.a,{onClick:a,children:"like"})})]}),Object(f.jsx)("tr",{children:Object(f.jsxs)("td",{colSpan:2,children:["added by ",t.user.name]})})]})}),Object(f.jsx)("div",{style:s,children:Object(f.jsx)(b.a,{variant:"danger",onClick:function(e){e.preventDefault(),window.confirm("Remove blog ".concat(t.title," by ").concat(t.author))&&r(function(e){return function(){var t=Object(l.a)(o.a.mark((function t(n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A.deleteBlog(e);case 2:n(R({success:!0,text:"".concat(e.title," deleted")})),n({type:"DELETE_BLOG",data:e});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t)),c.push("/")},children:"remove"})}),Object(f.jsx)("div",{children:Object(f.jsx)(V,{comments:t.comments,blogId:t.id})})]})},X=n(110),Y=n(112),Z=function(e){var t=e.user,n=e.logout;return Object(f.jsxs)(X.a,{bg:"light",expand:"lg",children:[Object(f.jsx)(Y.a.Link,{as:p.c,to:"/blogs",children:"blogs"}),Object(f.jsx)(Y.a.Link,{as:p.c,to:"/users",children:"users"}),Object(f.jsxs)(Y.a.Item,{children:[t.name," logged in"]}),Object(f.jsx)(Y.a.Link,{onClick:n,children:"logout"})]})},$={login:function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},ee=function(e){return function(t){t({type:"SET_USER",data:e})}},te=function(){return function(e){var t=window.localStorage.getItem("currentBloglistUser");if(t){var n=JSON.parse(t);e(ee(n)),A.setToken(n.token),console.log("user found:",n.username)}else console.log("user not found");e(function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.getAll();case 2:n=e.sent.sort(M),t({type:"SET_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},ne=function(e,t){return function(){var n=Object(l.a)(o.a.mark((function n(r){var c;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,$.login({username:e,password:t});case 3:c=n.sent,window.localStorage.setItem("currentBloglistUser",JSON.stringify(c)),r(ee(c)),A.setToken(c.token),r(R({success:!0,text:"logged in as ".concat(c.username)})),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(0),console.log("login failed"),r(R({success:!1,text:"wrong username or password"}));case 14:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e){return n.apply(this,arguments)}}()},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.data;case"LOGOUT":return null;default:return e}},ce=function(){var e=Object(K.f)(),t=Object(S.c)((function(e){return e.blogs})),n=Object(r.useState)(""),c=Object(d.a)(n,2),a=c[0],s=c[1],u=Object(r.useState)(""),j=Object(d.a)(u,2),b=j[0],h=j[1],p=Object(S.c)((function(e){return e.user})),v=Object(S.c)((function(e){return e.notification})),g=Object(S.c)((function(e){return e.users})),y=Object(S.b)(),I=Object(r.useRef)(),E=Object(r.useRef)(),L=Object(K.g)("/users/:id"),T=L?g.find((function(e){return e.id===L.params.id})):null,B=Object(K.g)("/blogs/:id"),C=B?t.find((function(e){return e.id===B.params.id})):null;Object(r.useEffect)((function(){y(te())}),[]);var U=function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),y(ne(a,b)),s(""),h("");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y(W(t,p)),E.current.setTitle(""),E.current.setAuthor(""),E.current.setUrl("");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return p?Object(f.jsxs)("div",{className:"container",children:[Object(f.jsx)(Z,{user:p,logout:function(t){t.preventDefault(),y((function(e){e(ee(null)),window.localStorage.removeItem("currentBloglistUser"),e(R({success:!0,text:"logged out"}))})),e.push("/")}}),Object(f.jsx)("h2",{children:"Bloglist"}),Object(f.jsx)(w,Object(i.a)({},v)),Object(f.jsxs)(K.c,{children:[Object(f.jsx)(K.a,{path:"/users/:id",children:Object(f.jsx)(N,{user:T})}),Object(f.jsxs)(K.a,{path:"/users",children:[Object(f.jsx)("h3",{children:"Users"}),Object(f.jsx)(_,{})]}),Object(f.jsx)(K.a,{path:"/blogs/:id",children:Object(f.jsx)(Q,{blog:C,user:p})}),Object(f.jsxs)(K.a,{path:"/",children:[Object(f.jsx)("h3",{children:"Blogs"}),Object(f.jsxs)(k,{buttonLabel:"create new blog",ref:I,children:[Object(f.jsx)("h3",{children:"Create new"}),Object(f.jsx)(m,{submitBlog:D,ref:E})]}),Object(f.jsx)(x,{blogs:t})]})]})]}):Object(f.jsx)("div",{className:"container",children:Object(f.jsx)(K.c,{children:Object(f.jsxs)(K.a,{path:"/",children:[Object(f.jsx)("h2",{children:"Login"}),Object(f.jsx)(w,Object(i.a)({},v)),Object(f.jsx)(O,{handleLogin:U,username:a,setUsername:s,password:b,setPassword:h})]})})})},ae=n(42),se=n(70),ie=n(71),ue=Object(ae.combineReducers)({notification:H,blogs:P,user:re,users:B}),oe=Object(ae.createStore)(ue,Object(se.composeWithDevTools)(Object(ae.applyMiddleware)(ie.a)));s.a.render(Object(f.jsx)(S.a,{store:oe,children:Object(f.jsx)(p.a,{children:Object(f.jsx)(ce,{})})}),document.getElementById("root"))}},[[105,1,2]]]);
//# sourceMappingURL=main.a1b0f83b.chunk.js.map