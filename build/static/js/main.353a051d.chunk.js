(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{68:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),s=n(19),a=n.n(s),i=n(12),u=n(2),o=n.n(u),l=n(4),d=n(15),j=n(1),b=function(e){var t=e.handleLogin,n=e.username,r=e.setUsername,c=e.password,s=e.setPassword;return Object(j.jsxs)("form",{onSubmit:t,children:[Object(j.jsxs)("div",{className:"loginField",children:["username",Object(j.jsx)("input",{id:"usernameInput",type:"text",value:n,name:"Username",onChange:function(e){var t=e.target;return r(t.value)}})]}),Object(j.jsxs)("div",{className:"loginField",children:["password",Object(j.jsx)("input",{id:"passwordInput",type:"text",value:c,name:"Password",onChange:function(e){var t=e.target;return s(t.value)}})]}),Object(j.jsx)("button",{id:"loginButton",type:"submit",children:"login"})]})},f=n(13),p=function(e){var t=e.blogs,n={paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5};return Object(j.jsx)("div",{children:t.map((function(e){return Object(j.jsx)("div",{style:n,children:Object(j.jsx)(f.b,{to:"/blogs/".concat(e.id),children:e.title})},e.id)}))})},h=c.a.forwardRef((function(e,t){var n=e.submitBlog,c=Object(r.useState)(""),s=Object(d.a)(c,2),a=s[0],i=s[1],u=Object(r.useState)(""),o=Object(d.a)(u,2),l=o[0],b=o[1],f=Object(r.useState)(""),p=Object(d.a)(f,2),h=p[0],O=p[1];return Object(r.useImperativeHandle)(t,(function(){return{title:a,setTitle:i,author:l,setAuthor:b,url:h,setUrl:O}})),Object(j.jsxs)("form",{onSubmit:function(e){e.preventDefault(),n({title:a,author:l,url:h,likes:0})},children:[Object(j.jsxs)("div",{children:["title:",Object(j.jsx)("input",{id:"blogFormTitle",type:"text",value:a,name:"title",onChange:function(e){var t=e.target;return i(t.value)}})]}),Object(j.jsxs)("div",{children:["author:",Object(j.jsx)("input",{id:"blogFormAuthor",type:"text",value:l,name:"author",onChange:function(e){var t=e.target;return b(t.value)}})]}),Object(j.jsxs)("div",{children:["url:",Object(j.jsx)("input",{id:"blogFormUrl",type:"text",value:h,name:"url",onChange:function(e){var t=e.target;return O(t.value)}})]}),Object(j.jsx)("button",{id:"blogFormSubmit",type:"submit",children:"create"})]})}));h.displayName="NewBlogForm";var O=h,x=function(e){var t=e.contents,n=e.isShowing,r=t?t.text:null;return n?Object(j.jsx)("div",{children:r}):Object(j.jsx)("div",{})},v=c.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),c=Object(d.a)(n,2),s=c[0],a=c[1],i={display:s?"none":""},u={display:s?"":"none"},o=function(){a(!s)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:o}})),Object(j.jsxs)("div",{className:"togglable",children:[Object(j.jsx)("div",{style:i,children:Object(j.jsx)("button",{className:"togglableButton",onClick:o,children:e.buttonLabel})}),Object(j.jsxs)("div",{style:u,children:[e.children,Object(j.jsx)("button",{onClick:o,children:"cancel"})]})]})}));v.displayName="Togglable";var g=v,m=n(9),w=n(14),y=n.n(w),k={getUsers:function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},S=function(e){return function(t){t({type:"SET_USERS_LIST",data:e})}},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USERS_LIST":return t.data;default:return e}},B=function(e){var t=e.name,n=e.blogs,r=e.id;return Object(j.jsxs)("tr",{children:[Object(j.jsx)("td",{children:Object(j.jsx)(f.b,{to:"/users/".concat(r),children:t})}),Object(j.jsx)("td",{children:n.length})]})},E=function(){var e=Object(m.b)(),t=Object(m.c)((function(e){return e.users}));return Object(r.useEffect)((function(){e(function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.getUsers();case 2:n=e.sent,t(S(n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(j.jsx)("div",{children:Object(j.jsx)("table",{children:Object(j.jsxs)("tbody",{children:[Object(j.jsxs)("tr",{children:[Object(j.jsx)("th",{}),Object(j.jsx)("th",{children:"blogs created"})]}),t.map((function(e){return Object(j.jsx)(B,{name:e.name,blogs:e.blogs,id:e.id},e.id)}))]})})})},L=function(e){var t=e.user,n=Object(m.c)((function(e){return e.blogs}));return t?Object(j.jsxs)("div",{children:[Object(j.jsx)("h3",{children:t.name}),Object(j.jsx)("h4",{children:"added blogs"}),Object(j.jsx)("ul",{children:n.filter((function(e){return e.user.id===t.id})).map((function(e){return Object(j.jsx)("li",{children:e.title},e.id)}))})]}):Object(j.jsx)("p",{children:"User ID not found"})},I=function(e){var t=e.blog,n=e.user,r=e.likeBlog,c=e.removeBlog;if(!t)return Object(j.jsx)("p",{children:"Blog ID not found"});var s=function(){var e=Object(l.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,r(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a=function(){var e=Object(l.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),!window.confirm("Remove blog ".concat(t.title," by ").concat(t.author))){e.next=4;break}return e.next=4,c(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i={display:n.username===t.user.username?"":"none"};return Object(j.jsxs)("div",{className:"detailedBlogInfo",children:[Object(j.jsx)("h3",{children:t.title}),Object(j.jsx)("div",{children:Object(j.jsx)("a",{href:"https://"+t.url,children:t.url})}),Object(j.jsxs)("div",{className:"blogLikes",children:[t.likes," likes",Object(j.jsx)("button",{onClick:s,children:"like"})]}),Object(j.jsxs)("div",{children:["added by ",t.user.name]}),Object(j.jsx)("div",{style:i,children:Object(j.jsx)("button",{onClick:a,children:"remove"})})]})},U=function(e){var t=e.user,n=e.logout;return Object(j.jsxs)("div",{style:{display:"inline"},children:[t.name," logged in",Object(j.jsx)("button",{onClick:n,children:"logout"})]})},_=function(e){var t=e.user,n=e.logout,r={display:"inline",padding:"5px"};return Object(j.jsxs)("ul",{style:{listStyleType:"none",margin:0,padding:"10px",backgroundColor:"lightgrey"},children:[Object(j.jsx)("li",{style:r,children:Object(j.jsx)(f.b,{to:"/blogs",children:"blogs"})}),Object(j.jsx)("li",{style:r,children:Object(j.jsx)(f.b,{to:"/users",children:"users"})}),Object(j.jsx)("li",{style:r,children:Object(j.jsx)(U,{user:t,logout:n})})]})},N="/api/blogs",C=null,D={getAll:function(){return y.a.get(N).then((function(e){return e.data}))},setToken:function(e){return C="bearer ".concat(e)},submit:function(){var e=Object(l.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:C}},e.next=3,y.a.post(N,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),like:function(){var e=Object(l.a)(o.a.mark((function e(t){var n,r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:C}},r=Object(i.a)(Object(i.a)({},t),{},{likes:t.likes+1}),e.next=4,y.a.put("".concat(N,"/").concat(t.id),r,n);case 4:return c=e.sent,e.abrupt("return",c.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(l.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:C}},e.next=3,y.a.delete("".concat(N,"/").concat(t.id),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},R={contents:{text:"Welcome to Bloglist!",success:!0},isShowing:!0},A=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2500;return function(n){setTimeout((function(){n(F())}),t),n({type:"SHOW_NOTIF",data:e})}},F=function(){return{type:"HIDE_NOTIF"}},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_NOTIF":return{contents:t.data,isShowing:!0};case"HIDE_NOTIF":return{contents:void 0,isShowing:!1};default:return e}},H=function(e,t){return t.likes-e.likes},W=function(e){return function(t){t({type:"CREATE_BLOG",data:e})}},J=function(e,t){return function(){var n=Object(l.a)(o.a.mark((function n(r){var c;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,D.submit(e);case 3:c=n.sent,console.log("blog submitted",c),r(W(Object(i.a)(Object(i.a)({},c),{},{user:t}))),r(A(c?{success:!0,text:"".concat(c.title," added")}:{success:!1,text:"blog creation failed"})),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(0),console.log("blog submission failed"),r(A({success:!1,text:"blog creation failed"}));case 13:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e){return n.apply(this,arguments)}}()},z=function(e){return function(){var t=Object(l.a)(o.a.mark((function t(n){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.like(e);case 2:r=t.sent,n(A(r?{success:!0,text:"".concat(e.title," liked")}:{success:!1,text:"".concat(e.title," does not exist")})),n({type:"LIKE_BLOG",data:e});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},P=function(e){return function(){var t=Object(l.a)(o.a.mark((function t(n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.deleteBlog(e);case 2:n(A({success:!0,text:"".concat(e.title," deleted")})),n({type:"DELETE_BLOG",data:e});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_BLOGS":return t.data;case"CREATE_BLOG":return e.concat(t.data);case"LIKE_BLOG":return e.map((function(e){return e.id===t.data.id?Object(i.a)(Object(i.a)({},e),{},{likes:e.likes+1}):e})).sort(H);case"DELETE_BLOG":return e.filter((function(e){return e.id!==t.data.id}));default:return e}},M={login:function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},V=function(e){return function(t){t({type:"SET_USER",data:e})}},q=function(){return function(e){var t=window.localStorage.getItem("currentBloglistUser");if(t){var n=JSON.parse(t);e(V(n)),D.setToken(n.token),console.log("user found:",n.username)}else console.log("user not found");e(function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.getAll();case 2:n=e.sent.sort(H),t({type:"SET_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},Q=function(e,t){return function(){var n=Object(l.a)(o.a.mark((function n(r){var c;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,M.login({username:e,password:t});case 3:c=n.sent,window.localStorage.setItem("currentBloglistUser",JSON.stringify(c)),r(V(c)),D.setToken(c.token),r(A({success:!0,text:"logged in as ".concat(c.username)})),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(0),console.log("login failed"),r(A({success:!1,text:"wrong username or password"}));case 14:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e){return n.apply(this,arguments)}}()},X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.data;case"LOGOUT":return null;default:return e}},Y=n(5),Z=function(){var e=Object(m.c)((function(e){return e.blogs})),t=Object(r.useState)(""),n=Object(d.a)(t,2),c=n[0],s=n[1],a=Object(r.useState)(""),u=Object(d.a)(a,2),f=u[0],h=u[1],v=Object(m.c)((function(e){return e.user})),w=Object(m.c)((function(e){return e.notification})),y=Object(m.c)((function(e){return e.users})),k=Object(m.b)(),S=Object(r.useRef)(),T=Object(r.useRef)(),B=Object(Y.f)("/users/:id"),U=B?y.find((function(e){return e.id===B.params.id})):null,N=Object(Y.f)("/blogs/:id"),C=N?e.find((function(e){return e.id===N.params.id})):null;Object(r.useEffect)((function(){k(q())}),[]);var D=function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),k(Q(c,f)),s(""),h("");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k(J(t,v)),T.current.setTitle(""),T.current.setAuthor(""),T.current.setUrl("");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k(z(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k(P(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return v?Object(j.jsxs)("div",{children:[Object(j.jsx)(_,{user:v,logout:function(e){e.preventDefault(),k((function(e){e(V(null)),window.localStorage.removeItem("currentBloglistUser"),e(A({success:!0,text:"logged out"}))})),T.current.setTitle(""),T.current.setAuthor(""),T.current.setUrl("")}}),Object(j.jsx)("h2",{children:"Blogs"}),Object(j.jsx)(x,Object(i.a)({},w)),Object(j.jsxs)(Y.c,{children:[Object(j.jsx)(Y.a,{path:"/users/:id",children:Object(j.jsx)(L,{user:U})}),Object(j.jsxs)(Y.a,{path:"/users",children:[Object(j.jsx)("h3",{children:"Users"}),Object(j.jsx)(E,{})]}),Object(j.jsx)(Y.a,{path:"/blogs/:id",children:Object(j.jsx)(I,{blog:C,user:v,likeBlog:F,removeblog:G})}),Object(j.jsxs)(Y.a,{path:"/",children:[Object(j.jsxs)(g,{buttonLabel:"create new blog",ref:S,children:[Object(j.jsx)("h3",{children:"Create new"}),Object(j.jsx)(O,{submitBlog:R,ref:T})]}),Object(j.jsx)(p,{blogs:e})]})]})]}):Object(j.jsxs)("div",{children:[Object(j.jsx)("h2",{children:"Login"}),Object(j.jsx)(x,Object(i.a)({},w)),Object(j.jsx)(b,{handleLogin:D,username:c,setUsername:s,password:f,setPassword:h})]})},$=n(18),ee=n(35),te=n(36),ne=Object($.combineReducers)({notification:G,blogs:K,user:X,users:T}),re=Object($.createStore)(ne,Object(ee.composeWithDevTools)(Object($.applyMiddleware)(te.a)));a.a.render(Object(j.jsx)(m.a,{store:re,children:Object(j.jsx)(f.a,{children:Object(j.jsx)(Z,{})})}),document.getElementById("root"))}},[[68,1,2]]]);
//# sourceMappingURL=main.353a051d.chunk.js.map